<!doctype html public "-//w3c//dtd xhtml 1.0 strict//en" "http://www.w3.org/tr/xhtml1/dtd/xhtml1-strict.dtd">
<html>

<head>
<title>WMI Command Manual</title>
<meta name="author" content="Chris Oldwood">
<style>
body	{ font-family: Verdana, Arial; font-size: 10pt }
table	{ border-collapse: collapse }
th		{ font-family: Verdana, Arial; font-size: 10pt; border: 1px solid black }
td		{ font-family: Verdana, Arial; font-size: 10pt; border: 1px solid black; vertical-align: top; padding: 5px }
</style>
</head>

<body>

<h3 align="center">WMI Command v1.0 [Alpha]</h3>

<a name="Introduction"></a>
<h5>Introduction</h5>

<p>
This is a command line (aka console) based tool for executing WMI queries. It
outputs a list of the matching objects with their relevant properties.
</p><p>
Like most of my tools, this was designed as a test harness for my WMI library
and was originally written before PowerShell was prevalent in the wild.
</p>

<a name="Commands"></a>
<h5>Commands</h5>

<p>
The tool currently only supports a single command, but the syntax allows for
future extensions. The basic format for invoking WMI Command is to run it with
a command type and then provide any arguments using switches, e.g.
</p>
<pre>
C:\> wmicmd command --option1 value1 --option2 value2
</pre>
<p>
The arguments can be specified using either Windows style (e.g. /option) or the
more common style (e.g. --option). Each switch has both a short name and a
longer name and you can see the list of all supported commands using "wmicmd -?".
Each command has its own help topic that describes it and lists the switches
that are applicable, e.g. wmicmd query -?.
</p>

<a name="QueryCommand"></a>
<h5>The Query Command</h5>

<p>
The query command allows you to execute a WMI query which is provided as a
single argument after the command name. It lists all the objects in the result
sets, dumping their available properties.
</p><pre>
C:\> wmicmd query "SELECT Name,State FROM Win32_Service"
Name: Alerter
State: Stopped
. . .
Name: Dhcp
State: Running
. . .
Name: xmlprov
State: Stopped
</pre><p>
The command can also be run against one or remote machines using the --hosts
switch. And, if required, an alternate set of credentials can be provided (the
same credentials will be used for all the listed hosts).
</p><pre>
C:\> wmicmd query "SELECT State FROM Win32_Service WHERE Name='w32time'" --hosts machine1 machine2 machine3
</pre>
<pre>
C:\> wmicmd query "SELECT State FROM Win32_Service WHERE Name='w32time'" --hosts srv1 srv2 --user admin --password p455w0rd
</pre>

<hr>

<a name="Warranty"></a>
<h5>License & Warranty</h5>

<p>
This application is freeware - you get what you pay for, nothing more, nothing
less.
</p>

<a name="SourceCode"></a>
<h5>Source Code</h5>

<p>
The full source code (C++) is available from my web site listed below.
</p>

<a name="Contact"></a>
<h5>Contact Details</h5>

<p>
Using the --version switch will also display my contact details. Please check the
web site for updates.
</p><p>
Email: <a href="mailto://gort@cix.co.uk">gort@cix.co.uk</a><br>
Web: <a href="http://www.cix.co.uk/~gort">www.cix.co.uk/~gort</a><br>
</p><p>
Chris Oldwood<br>
6th October 2010<br>
</p>

</body>

</html>
